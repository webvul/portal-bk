apply plugin: 'distribution'

dependencies {
    compile project(":cloud-store")
    compile project(":store-service")
    compile group: 'com.floragunn', name: 'search-guard-2', version: '2.3.3.0-rc1'
    compile "org.elasticsearch:elasticsearch:2.3.3"
    compile "com.fasterxml.jackson.core:jackson-databind:${jacksonVersion}"
    compile group: 'org.apache.httpcomponents', name: 'httpclient', version: '4.4.1'
}

distTar.shouldRunAfter(build)

distributions {
    main {
        contents {
            from getBuildDir().absolutePath + '/libs'
            from parent.project(":kii-sdk").getBuildDir().absolutePath + '/libs'
            from parent.project(":cloud-store").getBuildDir().absolutePath + '/libs'
            from parent.project(":store-service").getBuildDir().absolutePath + '/libs'

            //from configurations.compile.collect { it }
            from configurations.compile.find { it.name.startsWith("spring-beans") }
            from configurations.compile.find { it.name.startsWith("spring-core") }
            from configurations.compile.find { it.name.startsWith("jackson-databind") }
            from configurations.compile.find { it.name.startsWith("jackson-annotations") }
            from configurations.compile.find { it.name.startsWith("httpcore") }
            from configurations.compile.find { it.name.startsWith("httpclient") }
            from configurations.compile.find { it.name.startsWith("commons-logging") }
        }
    }
}